!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.W=e()}(this,function(){function t(){var t;if("orientation"in window){var e=window.orientation;t=90==e||e==-90}else t=window.innerWidth>window.innerHeight;return t?"landscape":"portrait"}function e(e){var n=screen.width,i=screen.height;if("landscape"==t()&&n<i&&(n=screen.height,i=screen.width),e)return{width:n,height:i};var o=window.innerWidth,r=window.innerHeight;return(!o||!r||o>n||r>i||980==o)&&(o=window.outerWidth,r=window.outerHeight),(!o||!r||o>n||r>i)&&(o=screen.availWidth,r=screen.availHeight),{width:o,height:r}}var n=[],i=!1,o=!1,r=!1;window.addEventListener?("onorientationchange"in window&&(o=!0,window.addEventListener("orientationchange",function(){r=!0},!1)),window.addEventListener("resize",function(){i=!0},!1)):window.attachEvent("onresize",function(){i=!0}),setInterval(function(){var t=!1;if(o?r&&i&&(t=!0):i&&(t=!0),t&&document.documentElement.clientWidth){r=!1,i=!1;for(var e=0,c=n.length;e<c;++e)n[e].func()}},10);var c={getViewportDimensions:function(t){return e(t)},getViewportWidth:function(t){return e(t).width},getViewportHeight:function(t){return e(t).height},getOrientation:function(){return t()},addListener:function(t,e){return n.push({func:t,key:e}),t},removeListener:function(t){for(var e=0,i=n.length;e<i;++e)if(n[e].key==t){n.splice(e,1);break}},clearListeners:function(){n=[]},trigger:function(t){for(var e=0,i=n.length;e<i;++e)"undefined"!=typeof t&&n[e].key!=t||n[e].func()}};return c}),!function(t){"use strict";function e(t){if(t){var e=this;t(function(t){e.resolve(t)},function(t){e.reject(t)})}}function n(t,e){if("function"==typeof t.y)try{var n=t.y.call(r,e);t.p.resolve(n)}catch(e){t.p.reject(e)}else t.p.resolve(e)}function i(t,e){if("function"==typeof t.n)try{var n=t.n.call(r,e);t.p.resolve(n)}catch(e){t.p.reject(e)}else t.p.reject(e)}var o,r,c="fulfilled",f="rejected",u="undefined",a=function(){function e(){for(;n.length-i;){try{n[i]()}catch(e){t.console&&t.console.error(e)}n[i++]=r,i==o&&(n.splice(0,o),i=0)}}var n=[],i=0,o=1024,c=function(){if(typeof MutationObserver!==u){var t=document.createElement("div"),n=new MutationObserver(e);return n.observe(t,{attributes:!0}),function(){t.setAttribute("a",0)}}return typeof setImmediate!==u?function(){setImmediate(e)}:function(){setTimeout(e,0)}}();return function(t){n.push(t),n.length-i==1&&c()}}();e.prototype={resolve:function(t){if(this.state===o){if(t===this)return this.reject(new TypeError("Attempt to resolve promise with self"));var e=this;if(t&&("function"==typeof t||"object"==typeof t))try{var i=!0,r=t.then;if("function"==typeof r)return void r.call(t,function(t){i&&(i=!1,e.resolve(t))},function(t){i&&(i=!1,e.reject(t))})}catch(t){return void(i&&this.reject(t))}this.state=c,this.v=t,e.c&&a(function(){for(var i=0,o=e.c.length;o>i;i++)n(e.c[i],t)})}},reject:function(n){if(this.state===o){this.state=f,this.v=n;var r=this.c;r?a(function(){for(var t=0,e=r.length;e>t;t++)i(r[t],n)}):!e.suppressUncaughtRejectionError&&t.console&&t.console.log("You upset Zousan. Please catch rejections: ",n,n?n.stack:null)}},then:function(t,r){var f=new e,u={y:t,n:r,p:f};if(this.state===o)this.c?this.c.push(u):this.c=[u];else{var h=this.state,s=this.v;a(function(){h===c?n(u,s):i(u,s)})}return f},catch:function(t){return this.then(null,t)},finally:function(t){return this.then(t,t)},timeout:function(t,n){n=n||"Timeout";var i=this;return new e(function(e,o){setTimeout(function(){o(Error(n))},t),i.then(function(t){e(t)},function(t){o(t)})})}},e.resolve=function(t){var n=new e;return n.resolve(t),n},e.reject=function(t){var n=new e;return n.reject(t),n},e.all=function(t){function n(n,c){n&&"function"==typeof n.then||(n=e.resolve(n)),n.then(function(e){i[c]=e,o++,o==t.length&&r.resolve(i)},function(t){r.reject(t)})}for(var i=[],o=0,r=new e,c=0;c<t.length;c++)n(t[c],c);return t.length||r.resolve(i),r},typeof module!=u&&module.exports&&(module.exports=e),t.define&&t.define.amd&&t.define([],function(){return e}),t.Zousan=e,e.soon=a}("undefined"!=typeof global?global:this),function(t,e){"function"==typeof define&&define.amd?define([],function(){return t.imagine=e()}):"object"==typeof exports?module.exports=e():t.imagine=e()}(this,function(){function t(t){return"object"==typeof t&&"length"in t||(t=[t]),new Zousan(function(e,n){var i,o,r,c=function(e){for(var n=[],i=0,o=t.length;i<o;++i)t[i].imagine==e&&n.push(t[i]);return n},f=function(){for(var e=0,n=t.length;e<n;++e)if(!("imagine"in t[e]))return!0;return!1},u=function(t){"undefined"==typeof t.imagine&&(t.imagine="loaded"),f()||(c("failed").length?n(c("failed")):e(c("loaded")))},a=function(t){return function(e){t.imagine="failed",f()||n(c("failed"))}},h=function(t){var e=setInterval(function(){t.complete&&t.width&&(clearInterval(e),u(t))},100)};for(o=0,r=t.length;o<r;++o)"string"==typeof t[o]?(i=new Image,i.src=t[o],t[o]=i):i=t[o],i.onerror=a(i),h(i)})}return t}),function(t,e){"function"==typeof define&&define.amd?define([],function(){return t.panorama=e()}):"object"==typeof exports?module.exports=e():t.panorama=e()}(this,function(){function t(t,e,n){var i,o,r=document.createElement("canvas"),c=function(t){var e,o,c,f;switch(n.size){case"cover":t.width/r.width>t.height/r.height?(c=Math.round(r.height/t.height*t.width),f=r.height):(f=Math.round(r.width/t.width*t.height),c=r.width);break;case"contain":t.width/r.width>t.height/r.height?(f=Math.round(r.width/t.width*t.height),c=r.width):(c=Math.round(r.height/t.height*t.width),f=r.height);break;default:throw new Error("'"+n.size+"' size option is not supported")}e="center"===n.left?(r.width-c)/2:n.left,o="center"===n.top?(r.height-f)/2:n.top,i.clearRect(0,0,r.width,r.height),i.drawImage(t,e,o,c,f)};return n=n||{},n.size="size"in n?n.size:"cover",n.attachment="attachment"in n?n.attachment:"scroll",n.left="left"in n?n.left:"center",n.top="top"in n?n.top:"center","string"==typeof e&&(e={0:e}),W.addListener(function(){var f,u,a=W.getViewportWidth(),h=0;for(u in e)u<=a&&(h=u);if(f=e[h],r.getContext&&(i=r.getContext("2d")))return r.style.position="scroll"==n.attachment?"absolute":"fixed",r.style.zIndex=-1,r.style.top=0,r.style.left=0,t.appendChild(r),imagine(f).then(function(e){r.draw=function(t){return function(){c(t)}}(e[0]),r.width=t.offsetWidth,r.height=t.offsetHeight,o&&o(e[0]),r.draw()});var s=n.left+("string"!=typeof n.left?"px":""),d=n.top+("string"!=typeof n.top?"px":"");t.style.backgroundImage="url("+f+")",t.style.backgroundSize=n.size,t.style.backgroundPosition=s+" "+d,t.style.backgroundRepeat="no-repeat",t.style.backgroundAttachment=n.attachment})(),{then:function(t){o=t}}}return t});